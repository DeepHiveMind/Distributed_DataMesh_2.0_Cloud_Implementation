{"paragraphs":[{"text":"%md\n\nspark.hadoop.fs.s3a.access.key = V42FCGRVMK24JJ8DHUYG\nspark.hadoop.fs.s3a.secret.key= bKhWxVF3kQoLY9kFmt91l+tDrEoZjqnWXzY9Eza","user":"admin","dateUpdated":"2020-04-23T05:51:30+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<p>spark.hadoop.fs.s3a.access.key = V42FCGRVMK24JJ8DHUYG<br/>spark.hadoop.fs.s3a.secret.key= bKhWxVF3kQoLY9kFmt91l+tDrEoZjqnWXzY9Eza</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1587621090036_-1615970759","id":"20200422-182557_1051931103","dateCreated":"2020-04-23T05:51:30+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:1471"},{"text":"import org.apache.spark.sql.types._\n\nval flightsSchema = StructType(Array(\n  StructField(\"year\", IntegerType, true),\n  StructField(\"month\", IntegerType, true),\n  StructField(\"dayOfMonth\", IntegerType, true),\n  StructField(\"dayOfWeek\", IntegerType, true),\n  StructField(\"depTime\", IntegerType, true),\n  StructField(\"crsDepTime\", IntegerType, true),\n  StructField(\"arrTime\", IntegerType, true),\n  StructField(\"crsArrTime\", IntegerType, true),\n  StructField(\"uniqueCarrier\", StringType, true),\n  StructField(\"flightNum\", StringType, true),\n  StructField(\"tailNum\", StringType, true),\n  StructField(\"actualElapsedTime\", IntegerType, true),\n  StructField(\"crsElapsedTime\", IntegerType, true),\n  StructField(\"airTime\", IntegerType, true),\n  StructField(\"arrDelay\", IntegerType, true),\n  StructField(\"depDelay\", IntegerType, true),\n  StructField(\"origin\", StringType, true),\n  StructField(\"dest\", StringType, true),\n  StructField(\"distance\", IntegerType, true),\n  StructField(\"taxiIn\", IntegerType, true),\n  StructField(\"taxiOut\", IntegerType, true),\n  StructField(\"cancelled\", StringType, true),\n  StructField(\"cancellationCode\", StringType, true),\n  StructField(\"diverted\", StringType, true),\n  StructField(\"carrierDelay\", StringType, true),\n  StructField(\"weatherDelay\", StringType, true),\n  StructField(\"nasDelay\", StringType, true),\n  StructField(\"securityDelay\", StringType, true),\n  StructField(\"lateAircraftDelay\", StringType, true)\n  )\n)","user":"admin","dateUpdated":"2020-04-23T05:51:30+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"import org.apache.spark.sql.types._\nflightsSchema: org.apache.spark.sql.types.StructType = StructType(StructField(year,IntegerType,true), StructField(month,IntegerType,true), StructField(dayOfMonth,IntegerType,true), StructField(dayOfWeek,IntegerType,true), StructField(depTime,IntegerType,true), StructField(crsDepTime,IntegerType,true), StructField(arrTime,IntegerType,true), StructField(crsArrTime,IntegerType,true), StructField(uniqueCarrier,StringType,true), StructField(flightNum,StringType,true), StructField(tailNum,StringType,true), StructField(actualElapsedTime,IntegerType,true), StructField(crsElapsedTime,IntegerType,true), StructField(airTime,IntegerType,true), StructField(arrDelay,IntegerType,true), StructField(depDelay,IntegerType,true), StructField(origin,StringType,true), Stru..."}]},"apps":[],"jobName":"paragraph_1587621090061_-774359927","id":"20200422-182628_14018539","dateCreated":"2020-04-23T05:51:30+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:1472"},{"text":"val flightsDf = spark.read.format(\"csv\")\n  .option(\"delimiter\",\",\")\n  .option(\"header\", \"false\")\n  .schema(flightsSchema)\n  .load(\"s3a://flight-bucket/landing/flights/flights_2018_5_1.csv\")","user":"admin","dateUpdated":"2020-04-23T05:51:30+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"flightsDf: org.apache.spark.sql.DataFrame = [year: int, month: int ... 27 more fields]\n"}]},"apps":[],"jobName":"paragraph_1587621090062_320733562","id":"20200422-182728_259863474","dateCreated":"2020-04-23T05:51:30+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:1473"},{"text":"flightsDf.printSchema()","user":"admin","dateUpdated":"2020-04-23T05:51:30+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"root\n |-- year: integer (nullable = true)\n |-- month: integer (nullable = true)\n |-- dayOfMonth: integer (nullable = true)\n |-- dayOfWeek: integer (nullable = true)\n |-- depTime: integer (nullable = true)\n |-- crsDepTime: integer (nullable = true)\n |-- arrTime: integer (nullable = true)\n |-- crsArrTime: integer (nullable = true)\n |-- uniqueCarrier: string (nullable = true)\n |-- flightNum: string (nullable = true)\n |-- tailNum: string (nullable = true)\n |-- actualElapsedTime: integer (nullable = true)\n |-- crsElapsedTime: integer (nullable = true)\n |-- airTime: integer (nullable = true)\n |-- arrDelay: integer (nullable = true)\n |-- depDelay: integer (nullable = true)\n |-- origin: string (nullable = true)\n |-- dest: string (nullable = true)\n |-- distance: integer (nullable = true)\n |-- taxiIn: integer (nullable = true)\n |-- taxiOut: integer (nullable = true)\n |-- cancelled: string (nullable = true)\n |-- cancellationCode: string (nullable = true)\n |-- diverted: string (nullable = true)\n |-- carrierDelay: string (nullable = true)\n |-- weatherDelay: string (nullable = true)\n |-- nasDelay: string (nullable = true)\n |-- securityDelay: string (nullable = true)\n |-- lateAircraftDelay: string (nullable = true)\n\n"}]},"apps":[],"jobName":"paragraph_1587621090063_-1707353976","id":"20200422-183907_1375241642","dateCreated":"2020-04-23T05:51:30+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:1474"},{"text":"val flightsFilteredDf = flightsDf.filter(\"year is not null\")","user":"admin","dateUpdated":"2020-04-23T05:51:30+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"flightsFilteredDf: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [year: int, month: int ... 27 more fields]\n"}]},"apps":[],"jobName":"paragraph_1587621090065_190252314","id":"20200422-183933_479320336","dateCreated":"2020-04-23T05:51:30+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:1475"},{"text":"flightsFilteredDf.write.format(\"delta\").mode(\"append\").partitionBy(\"year\",\"month\").save(\"s3a://flight-bucket/raw/delta/flights\")","user":"admin","dateUpdated":"2020-04-23T05:51:30+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1587621090065_-205956035","id":"20200422-182748_62338729","dateCreated":"2020-04-23T05:51:30+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:1476"},{"text":"import io.delta.tables._\n\nval deltaTable = DeltaTable.forPath(spark,\"s3a://flight-bucket/raw/delta/flights\")\ndeltaTable.generate(\"symlink_format_manifest\")\n","user":"admin","dateUpdated":"2020-04-23T05:51:30+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"import io.delta.tables._\ndeltaTable: io.delta.tables.DeltaTable = io.delta.tables.DeltaTable@40724de5\n"}]},"apps":[],"jobName":"paragraph_1587621090066_-1989311189","id":"20200422-182801_1954659680","dateCreated":"2020-04-23T05:51:30+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:1477"},{"text":"flightsFilteredDf.write.format(\"parquet\").partitionBy(\"year\",\"month\").save(\"s3a://flight-bucket/raw/parquet/flights\")","user":"admin","dateUpdated":"2020-04-23T05:51:30+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1587621090066_1151454843","id":"20200422-182805_1541899552","dateCreated":"2020-04-23T05:51:30+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:1478"},{"user":"admin","dateUpdated":"2020-04-23T05:51:30+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1587621090067_-609423565","id":"20200422-203705_654745396","dateCreated":"2020-04-23T05:51:30+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:1479"}],"name":"Minio and Delta Lake","id":"2F9J9DDDD","noteParams":{},"noteForms":{},"angularObjects":{},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}